# -*- coding: utf-8 -*-
"""Mini Project1-LEE.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/17--njVjpfq3oRLh_ZPfattEMSAiKAOSR
"""

# âœ… 1. í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
!pip install streamlit pyngrok --quiet

# âœ… 2. ngrok ì¸ì¦ í† í° ë“±ë¡ (ðŸ‘‰ ngrok ê°€ìž… í›„ ë°›ì€ í† í°ìœ¼ë¡œ êµì²´í•˜ì„¸ìš”)
# í† í°ì€ https://dashboard.ngrok.com/get-started/your-authtoken ì—ì„œ í™•ì¸ ê°€ëŠ¥
!ngrok config add-authtoken 2yP4Gt799Muq4gpuqxZ48CS7DQm_2coEa2vioWcycKYcDjAh3

# âœ… 3. Streamlit ì•± ì½”ë“œ ì €ìž¥ (Met Museum API ì—°ë™)
code = """
import streamlit as st
import requests

st.set_page_config(page_title='ðŸŽ¨ ì˜ˆìˆ  ìž‘í’ˆ íƒìƒ‰ê¸°', layout='wide')
st.title("ðŸ–¼ï¸ ë©”íŠ¸ë¡œí´ë¦¬íƒ„ ë¯¸ìˆ ê´€ ìž‘í’ˆ íƒìƒ‰ê¸°")

object_id = st.number_input("ðŸ”Ž ìž‘í’ˆ IDë¥¼ ìž…ë ¥í•˜ì„¸ìš”", min_value=1, value=436535)

@st.cache_data
def get_artwork(object_id):
    url = f"https://collectionapi.metmuseum.org/public/collection/v1/objects/{object_id}"
    res = requests.get(url)
    return res.json() if res.status_code == 200 else {}

if st.button("ìž‘í’ˆ ì¡°íšŒ"):
    data = get_artwork(object_id)
    if data.get("objectID"):
        st.subheader(data.get("title", "ì œëª© ì—†ìŒ"))
        if data.get("primaryImageSmall"):
            st.image(data["primaryImageSmall"], caption=data.get("artistDisplayName", ""), use_column_width=True)
        info_md = f'''
- ðŸ‘¨â€ðŸŽ¨ ìž‘ê°€: **{data.get("artistDisplayName", "ì •ë³´ ì—†ìŒ")}**
- ðŸ•° ì œìž‘ì—°ë„: **{data.get("objectDate", "ë¯¸ìƒ")}**
- ðŸ› ë¶€ì„œ: {data.get("department", "ì •ë³´ ì—†ìŒ")}
- ðŸ“ ì„¤ëª…: {data.get("creditLine", "ì •ë³´ ì—†ìŒ")}
'''
        st.markdown(info_md)
    else:
        st.error("í•´ë‹¹ IDì— ëŒ€í•œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
"""

# âœ… 4. ì½”ë“œ íŒŒì¼ë¡œ ì €ìž¥
with open("app.py", "w") as f:
    f.write(code)

# âœ… 5. ngrokìœ¼ë¡œ í¬íŠ¸ í„°ë„ë§ ì—°ê²°
from pyngrok import ngrok
public_url = ngrok.connect(8501)
print(f"ðŸŒ ì—¬ê¸°ë¥¼ í´ë¦­í•´ì„œ Streamlit ì•± ì—´ê¸° ðŸ‘‰ {public_url}")

# âœ… 6. Streamlit ì•± ì‹¤í–‰
!streamlit run app.py &> /dev/null &

